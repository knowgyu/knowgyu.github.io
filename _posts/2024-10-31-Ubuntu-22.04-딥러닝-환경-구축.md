---
title: "Ubuntu 22.04 ë”¥ëŸ¬ë‹ í™˜ê²½ êµ¬ì¶•"
author: knowgyu
description: " "
date: 2023-08-24 13:47:04 +0900
math: true
categories: [ê°œë°œ í™˜ê²½ êµ¬ì¶•]
tags: [ë”¥ëŸ¬ë‹, Ubuntu, ê°œë°œ í™˜ê²½ êµ¬ì¶•]
---

## PC ì‚¬ì–‘
CPU : I7-11700F (amd64)
GPU : GTX2080 SUPER
OS : Ubuntu22.04
***
ë³¸ ë¬¸ì„œì—ì„œëŠ” Ubuntu22.04ì—ì„œ ë”¥ëŸ¬ë‹ ê³µë¶€ë¥¼ ìœ„í•œ í™˜ê²½ êµ¬ì¶•ì„ í•˜ê² ìŠµë‹ˆë‹¤.

# 1. Nvidia Driver ì„¤ì¹˜
### ê¶Œì¥ ë“œë¼ì´ë²„ ìë™ ì„¤ì¹˜
```bash
sudo ubuntu-drivers autoinstall
```

### ë“œë¼ì´ë²„ ìˆ˜ë™ ì„¤ì¹˜
```bash
# if gcc is not installed
sudo apt update
sudo apt install build-essential


uname -r
sudo apt-get install linux-headers-$(uname -r)

# ì„¤ì¹˜ ê°€ëŠ¥í•œ ë“œë¼ì´ë²„ ë²„ì „ ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
ubuntu-drivers devices

## 23ë…„ 8ì›” ê¸°ì¤€ ê¶Œì¥ ë²„ì „ì€ 535
sudo apt install nvidia-driver-535
sudo reboot
```
- ì„¤ì¹˜ í™•ì¸
```
gyu@gyu:~$ nvidia-smi
Wed Aug 23 00:28:18 2023       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.1     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA GeForce RTX 3050 ...    Off | 00000000:01:00.0 Off |                  N/A |
| N/A   48C    P8               8W /  35W |    617MiB /  4096MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A      1345      G   /usr/lib/xorg/Xorg                          292MiB |
|    0   N/A  N/A      3508    C+G   ...61033818,9382365274700985078,262144      308MiB |
+---------------------------------------------------------------------------------------+
```

# 2. CUDA 11.8 ì„¤ì¹˜
ë³¸ì¸ì´ ì‚¬ìš©í•˜ë ¤ëŠ” í™˜ê²½ì— ë§ê²Œ CUDAë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.
ë³¸ í˜ì´ì§€ì—ì„œëŠ” 11.8ë²„ì „ì„ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.
https://developer.nvidia.com/cuda-11-8-0-download-archive?target_os=Linux&target_arch=x86_64&Distribution=Ubuntu&target_version=22.04&target_type=runfile_local

![](https://velog.velcdn.com/images/noehuyg/post/23d7c54a-c1f0-458f-a603-431a2558a158/image.png)

ë²„ì „ì„ ì„ íƒí•˜ë©´ ì•„ë˜ ì´ë¯¸ì§€ì™€ ê°™ì´ ì„¤ì¹˜ ë°©ë²•ì´ ë‚˜ì˜µë‹ˆë‹¤.
![](https://velog.velcdn.com/images/noehuyg/post/e5324e6e-37c0-4e0a-bc1b-ff6b9c4bd1c0/image.png)

# 3. cuDNN 8.9.3 ì„¤ì¹˜
  cuDNNì˜ ê²½ìš° Nvidia ê³„ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.
  https://developer.nvidia.com/rdp/cudnn-archive
  ![](https://velog.velcdn.com/images/noehuyg/post/44abc31d-c135-41eb-96c0-ac64df1cda45/image.png)
ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì— ë§ê²Œ Local Installerë¥¼ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.
ë³¸ í˜ì´ì§€ì—ì„œëŠ” `Local Installer for Ubuntu22.04 x86_64 (Deb)`ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.
```bash
tar -xvf cudnn-linux-x86_64-8.8.1.3_cuda11-archive.tar.xz

## after unzip
sudo cp cudnn-linux-x86_64-8.8.1.3_cuda11-archive/include/cudnn*.h /usr/local/cuda/include
sudo cp cudnn-linux-x86_64-8.8.1.3_cuda11-archive/lib/libcudnn* /usr/local/cuda/lib64
sudo chmod a+r /usr/local/cuda/include/cudnn*.h /usr/local/cuda/lib64/libcudnn*
```
```bash
# ì„¤ì¹˜ í™•ì¸
cat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2
```

> cuDNN Symbolic link ì˜¤ë¥˜ ë°œìƒ ì‹œ ì•„ë˜ ë§í¬ë¥¼ ì°¸ê³ í–ˆìŠµë‹ˆë‹¤.
https://lapina.tistory.com/130

# 4. Conda ì„¤ì¹˜
https://repo.anaconda.com/archive/
ë³¸ì¸ì˜ í™˜ê²½ì— ë§ê²Œ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.
ë³¸ í˜ì´ì§€ì—ì„œëŠ” `Anaconda3-2023.09-0-Linux-x86_64.sh`ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê² ìŠµë‹ˆë‹¤.
![](https://velog.velcdn.com/images/noehuyg/post/692e3e0f-c8a0-4153-b71f-9238ce3ceab1/image.png)
í´ë¦­ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ í˜¹ì€ `curl` ëª…ë ¹ì–´ë¥¼ í†µí•´ ë‹¤ìš´ë¡œë“œ
```bash
curl --output conda_install.sh https://repo.anaconda.com/archive/Anaconda3-2023.09-0-Linux-x86_64.sh
```

ë‹¤ìš´ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆë‹¤ë©´ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
```bash
# Match the "SHA-256" Checksum
# sha256sum conda_install.sh (Optional)
bash conda_install.sh
```
ì„¤ì¹˜ ì§„í–‰ ì¤‘ ì—¬ëŸ¬ì°¨ë¡€ yesë¥¼ ì…ë ¥í•˜ë©´ ì„¤ì¹˜ê°€ ì™„ë£Œë©ë‹ˆë‹¤.
```bash
Enter
yes
ì„¤ì¹˜ ê²½ë¡œ ì…ë ¥ í˜¹ì€ Enter
no # yesë¥¼ ì…ë ¥í•  ê²½ìš° shellì—ì„œ conda í™˜ê²½ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©
```
> ğŸ’¡ ì„¤ì¹˜ ì¤‘ Anaconda3 ê²½ë¡œë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ê¸°ë³¸ ê²½ë¡œëŠ” /home/{USER}/anaconda3ë¡œ í™ˆ ë””ë ‰í† ë¦¬ì— ìƒì„±ë©ë‹ˆë‹¤.

í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
```bash
sudo vi ~/.bashrc
```
```
# ì•„ë˜ ì¤„ ì¶”ê°€
export PATH=~/anaconda3/bin:~/anaconda3/condabin:$PATH
```
ì„¤ì¹˜ í™•ì¸
```bash
conda -V
```


# 5. PyTorch ì„¤ì¹˜
https://pytorch.org/get-started/locally/
23ë…„ 8ì›” ê¸°ì¤€ latest ë²„ì „ì€ 2.0.1ì…ë‹ˆë‹¤.
ë³¸ì¸ì˜ í™˜ê²½ì— ë§ê²Œ ì„ íƒí•œ í›„ ìƒì„±ë˜ëŠ” ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ì°½ì— ì…ë ¥í•©ë‹ˆë‹¤.
![](https://velog.velcdn.com/images/noehuyg/post/a6572218-2df3-487d-afae-50139bdd12da/image.png)

ì„¤ì¹˜ í›„ GPU ì‚¬ìš©ì„ í™•ì¸í•©ë‹ˆë‹¤.
```bash
$ python
>> import torch
>> torch.cuda.is_available()
True
```
ë§Œì•½ Falseê°€ ì¶œë ¥ëœë‹¤ë©´, Nvidia driver, CUDA, cuDNNì„ ì œëŒ€ë¡œ ì„¤ì¹˜í–ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
> CUDAì™€ cuDNNì„ ì„¤ì¹˜í–ˆëŠ”ë°, `nvcc -V` ëª…ë ¹ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ë‹¤ëŠ” ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´, CUDA í™˜ê²½ë³€ìˆ˜ë¥¼ ì œëŒ€ë¡œ ì§€ì •í–ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

---
# + alias ì„¤ì •
ìš°ë¶„íˆ¬ë¥¼ ì‚¬ìš©í•´ ê³µë¶€ë¥¼ í•˜ëŠ” ì¤‘, `source ~/.bashrc` í˜¹ì€ `conda activate [í™˜ê²½ì´ë¦„]` ê³¼ ê°™ì´ ìì£¼ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ëª…ë ¹ì–´ê°€ ë§ì´ ìˆì—ˆìŠµë‹ˆë‹¤.

ë˜ëŠ”, ì•„ë˜ëŠ” ì œê°€ MLflow ê³µë¶€ë¥¼ í•˜ë©° Tracking serverë¥¼ êµ¬ë™í•˜ê¸° ìœ„í•œ ëª…ë ¹ì–´ì…ë‹ˆë‹¤. 
```bash
mlflow server --backend-store-uri sqlite:///mlflow.db \
--default-artifact-root $(pwd)/artifacts \
--host 0.0.0.0 --port 8888
```
ìœ„ì™€ ê°™ì´ ìì£¼ ë³€ê²½í•˜ì§€ ì•Šì§€ë§Œ, ìì£¼ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì–´ì˜ ê²½ìš° ì¼ì¼íˆ ì¹˜ê¸° ë²ˆê±°ë¡œì› ìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì´ë ‡ê²Œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì–´ë“¤ì„ `alias`ë¥¼ í†µí•´ ëª…ë ¹ì–´ë¥¼ ê°„ì†Œí™”í•˜ê² ìŠµë‹ˆë‹¤.
```bash
vi ~/.bashrc
```
```
...ìƒëµ
alias sb='source ~/.bashrc'
alias eb='vi ~/.bashrc'

alias CA='conda activate'
alias CD='conda deactivate'
...ìƒëµ
```
```bash
# ì ìš©í•˜ê¸°
sourcve ~/.bashrc
```
> âš ï¸ ê¸°ë³¸ ëª…ë ¹ì–´ì™€ ê²¹ì¹˜ì§€ ì•Šê²Œ ì£¼ì˜í•©ë‹ˆë‹¤!!


ìœ„ì™€ ê°™ì´ ì„¤ì •í•˜ë©´, `CA` ëª…ë ¹ì–´ë¥¼ í†µí•´ conda ê°€ìƒí™˜ê²½ì„ ì¼¤ ìˆ˜ ìˆê³ , `CA yolov7`ê³¼ ê°™ì´ ì‚¬ìš©í•´ ì´ë¯¸ ë§Œë“¤ì–´ë‘” ê°€ìƒí™˜ê²½ì„ í¸í•˜ê²Œ ì¼¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  
í•˜ì§€ë§Œ, ì‚¬ìš©í•˜ë‹¤ë³´ë©´ `~/.bashrc`íŒŒì¼ì´ ì§€ì €ë¶„í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì´ë¥¼ ìœ„í•´ `~/.bashrc_aliases` íŒŒì¼ì„ ìƒì„±í•´ ì´ íŒŒì¼ì— `alias` ëª…ë ¹ì–´ë¥¼ ì‘ì„±í•œ í›„, `~/.bashrc`ì—ì„œ ë¶ˆëŸ¬ì˜¤ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
```bash
vi ~/.bashrc_aliases
```
```
alias sb='source ~/.bashrc'
alias eb='vi ~/.bashrc'

# Conda ëª…ë ¹ì–´
alias CA='conda activate'
alias CD='conda deactivate'

# MLflow ëª…ë ¹ì–´
alias mls='mlflow server --backend-store-uri sqlite:///mlflow.db \
--default-artifact-root $(pwd)/artifacts \
--host 0.0.0.0 --port 8888'

# Git ëª…ë ¹ì–´
alias gs='git status'

...ë“±ë“±
```

ì´ì œ, `~/.bashrc` íŒŒì¼ì—ì„œ `~/.bashrc_aliases`ë¥¼ ë¶ˆëŸ¬ì˜¤ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
```bash
eb
```
```
...ìƒëµ
if [ -f ~/.bash_aliases ]; then
    . ~/.bash_aliases
fi
...ìƒëµ
```
```
sb
```

ì´ë ‡ê²Œ í•˜ë©´ `~/.bashrc`ë¥¼ ê¹”ë”í•˜ê²Œ ìœ ì§€í•˜ë©° `~/.bashrc_aliases`ì— `alias`í•  ëª…ë ¹ì–´ë“¤ì„ ì •ë¦¬í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

