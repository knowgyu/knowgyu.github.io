---
title: "[혼공컴운] 10장 프로세스와 스레드"
author: knowgyu
description: " "
date: 2024-09-10 06:55:10 +0900
categories: [Computer Science, 혼자 공부하는 컴퓨터구조+운영체제]
tags: [컴퓨터구조, 운영체제]
---

# 10-1 프로세스 개요

---

## 프로그램과 프로세스

**프로그램**은 실행 전까지는 **보조기억장치**에 저장된 **데이터**에 불과합니다.  
하지만 프로그램이 **메모리에 적재**되어 **실행**되는 순간, **프로세스**가 됩니다.  
이것을 **"프로세스를 생성한다"**라고 합니다.

---

## 프로세스 확인하기

프로세스는 다음과 같은 방법으로 확인할 수 있습니다.  

- **Windows**: 작업 관리자(Task Manager)  
- **Linux/Unix**: `ps -ef` 명령어  

프로세스는 실행 형태에 따라 두 가지로 구분됩니다.

1. **포그라운드 프로세스**: 사용자가 직접 실행하고 상호작용하는 프로세스.  
2. **백그라운드 프로세스**: 화면에 보이지 않지만 실행되는 프로세스.  

> **데몬(Daemon)**: 유닉스 체계에서 사용자와 상호작용 없이 정해진 일만 수행하는 백그라운드 프로세스.  
> **서비스(Service)**: 윈도우에서 동일한 역할을 수행합니다.  
{: .prompt-info }

---

## 프로세스 제어 블록(PCB)

운영체제는 여러 프로세스를 **번갈아 가며 실행**하고 자원을 **효율적으로 분배**합니다.  
이를 위해 프로세스 정보를 저장하는 **프로세스 제어 블록(PCB)**을 사용합니다.

### PCB에 포함되는 정보  

- **프로세스 ID (PID)**  
  특정 프로세스를 식별하기 위한 **고유한 번호**입니다.

- **레지스터 값**  
  프로그램 카운터를 포함한 **레지스터 정보**를 저장합니다.

- **프로세스 상태**  
  프로세스가 **CPU를 기다리는지**, **실행 중인지**, **입출력 작업 중인지** 등의 상태를 기록합니다.

- **CPU 스케줄링 정보**  
  언제, 어떤 순서로 **CPU를 할당받는지**에 대한 정보가 기록됩니다.

- **메모리 관리 정보**  
  프로세스의 메모리 영역 정보가 저장됩니다.  
  예: 베이스 레지스터, 한계 레지스터, 페이지 테이블 등.

---

## 문맥 교환(Context Switching)

**문맥 교환**은 프로세스 A의 실행이 중단되고 프로세스 B로 **전환될 때** 발생합니다.  

1. **프로세스 A의 컨텍스트(실행 정보)**를 PCB에 저장합니다.  
2. **프로세스 B의 컨텍스트**를 PCB에서 복구해 실행을 재개합니다.

> **컨텍스트**란 프로세스 수행을 재개하기 위해 필요한 **모든 정보**입니다.  
{: .prompt-info }

> **문맥 교환의 특징**  
> 문맥 교환은 **오버헤드**를 발생시킵니다. 편리하지만 성능 저하를 초래할 수 있으므로 효율적으로 관리해야 합니다.  
{: .prompt-warning }

---

## 프로세스의 메모리 영역

**PCB**는 **커널 영역**에 저장되며, **사용자 영역**에는 다음과 같은 메모리 영역이 존재합니다.

| **메모리 영역** | **설명**                                                            |
| --------------- | ------------------------------------------------------------------- |
| **코드 영역**   | 실행할 수 있는 기계어 명령어가 저장된 **읽기 전용** 공간입니다.     |
| **데이터 영역** | 프로그램 실행 동안 유지되는 **전역 변수, 정적 변수**를 저장합니다.  |
| **힙 영역**     | **프로그래머가 동적으로 할당**하는 메모리입니다. 반환이 필요합니다. |
| **스택 영역**   | **함수 실행 시** 생성되는 매개변수, 지역 변수를 저장합니다.         |

---

### 동적 할당과 정적 할당

- **코드 영역과 데이터 영역**: **정적 할당** 영역입니다. 크기가 고정되어 있습니다.  
- **힙 영역과 스택 영역**: **동적 할당** 영역입니다.  

> **할당 방향**  
> - **스택 영역**: 상위 주소 → 하위 주소로 할당됩니다.  
> - **힙 영역**: 하위 주소 → 상위 주소로 할당됩니다.  
{: .prompt-tip }

> **메모리 누수(Memory Leak)**  
> 힙 영역에 할당한 메모리를 반환하지 않으면 **메모리 낭비**가 발생합니다. 이를 **메모리 누수**라고 합니다.  
{: .prompt-warning }

---

# 10-2 프로세스 상태와 계층 구조

---

## 프로세스 상태

운영체제마다 조금씩 다를 수 있지만, 일반적으로 **프로세스의 상태**는 다음과 같이 나뉩니다.

1. **생성 상태 (New)**  
   - 이제 막 **메모리에 적재**되어 **PCB**를 할당받은 상태입니다.  
   - 이 상태를 거쳐 실행 준비가 완료되면 **준비 상태**로 전환됩니다.  

2. **준비 상태 (Ready)**  
   - CPU를 **할당받기 위해 대기 중**인 상태입니다.  
   - 아직 실행되지 않았지만, 언제든 실행될 준비가 되어 있습니다.  

3. **실행 상태 (Running)**  
   - CPU를 할당받아 **명령어를 실행 중**인 상태입니다.  
   - 할당된 시간을 모두 사용하면 **준비 상태**로 돌아가거나, **입출력 장치**의 작업을 기다려야 하면 **대기 상태**로 전환됩니다.

4. **대기 상태 (Blocked)**  
   - 입출력 장치의 작업을 **기다리는 상태**입니다.  
   - 입출력이 완료되면 **인터럽트**를 받아 다시 **준비 상태**로 전환됩니다.  

5. **종료 상태 (Terminated)**  
   - 프로세스의 실행이 **완료된 상태**입니다.  
   - 운영체제는 PCB와 프로세스가 사용한 **메모리**를 정리합니다.

> **디스패치 (Dispatch)**:  
> 준비 상태에서 CPU를 할당받아 실행 상태로 전환되는 것을 **디스패치**라고 합니다.  
{: .prompt-info }
---

## 프로세스 계층 구조

프로세스는 **시스템 콜**을 통해 **다른 프로세스를 생성**할 수 있습니다.  

- **부모 프로세스**가 **자식 프로세스**를 생성합니다.  
- 부모와 자식 프로세스는 **서로 다른 PID**(Process ID)를 가집니다.  
- 자식 프로세스도 다른 프로세스를 생성할 수 있으며, 이 구조는 **트리 구조**를 형성합니다.

---

### 최초의 프로세스

모든 프로세스의 시작점은 **최초의 프로세스**입니다.

| **운영체제** | **최초의 프로세스** | **PID** |
| ------------ | ------------------- | ------- |
| **유닉스**   | `init`              | 1       |
| **리눅스**   | `systemd`           | 1       |
| **macOS**    | `launchd`           | 1       |

> **최초의 프로세스**는 항상 PID가 **1번**이며, 모든 프로세스의 **최상위 부모 프로세스**입니다.  
{: .prompt-tip }

---

## 프로세스 생성 기법

프로세스를 생성하는 주요 시스템 콜은 **`fork`**와 **`exec`**입니다.

1. **fork**  
   - 부모 프로세스의 **복사본**을 자식 프로세스로 생성합니다.  
   - 자식 프로세스는 부모의 모든 자원을 **상속**받지만, **PID**는 다릅니다.  

2. **exec**  
   - 자식 프로세스의 메모리 공간을 **다른 프로그램**으로 교체합니다.  
   - 새로운 프로그램이 메모리에 적재되고 실행됩니다.

---

### 프로세스 생성 과정 예시

1. 부모 프로세스가 **fork** 시스템 콜을 호출해 자신의 복사본을 생성합니다.  
2. 자식 프로세스는 **exec** 시스템 콜을 호출해 **새로운 프로그램**을 실행합니다.  

> **참고**:  
> `fork` 후 자식 프로세스가 `exec`를 호출하지 않고 부모와 **같은 코드**를 병행해 실행하는 경우도 있습니다.  
{: .prompt-info }

---

# 10-3 스레드

---

## 프로세스와 스레드

**스레드(Thread)**는 프로세스를 구성하는 **실행의 흐름 단위**입니다.  
하나의 프로세스는 여러 개의 **스레드**를 가질 수 있습니다.

---

### 단일 스레드와 스레드 개념의 도입  

- **단일 스레드 프로세스**:  
  코드가 **위에서 아래로 순차적으로** 하나의 일을 실행합니다.

- **스레드의 도입**:  
  하나의 프로세스에서 여러 개의 스레드를 생성하여 **동시에 여러 작업을 처리**할 수 있게 되었습니다.

---

### 스레드의 구성 요소

각 스레드는 다음과 같은 구성 요소를 가집니다.  

- **스레드 ID**: 스레드를 식별하는 고유한 ID.  
- **프로그램 카운터**: 실행할 명령어의 위치를 가리킵니다.  
- **레지스터 값**: 스레드마다 별도의 레지스터 값을 가집니다.  
- **스택**: 각 스레드의 함수 호출 정보와 지역 변수를 저장합니다.  

> **공유 자원**  
> 스레드들은 같은 **코드 영역, 힙 영역, 데이터 영역**을 공유합니다.  
> 하지만 **스택**과 **레지스터**는 독립적으로 가집니다.  
{: .prompt-tip }

---

> **참고**  
> 리눅스에서는 프로세스와 스레드를 명확히 구분하지 않고 **태스크(Task)**라는 용어를 사용합니다.  
{: .prompt-info }

---

## 멀티프로세스와 멀티스레드

**멀티프로세스**와 **멀티스레드**는 동시에 여러 작업을 처리하는 방법입니다.

1. **멀티프로세스**  
   - 여러 **독립된 프로세스**를 동시에 실행하는 방식입니다.  
   - 각 프로세스는 **메모리 공간**을 독립적으로 사용합니다.

2. **멀티스레드**  
   - 하나의 **프로세스 내**에서 여러 **스레드**를 동시에 실행하는 방식입니다.  
   - 스레드들은 **코드, 힙, 데이터 영역**을 공유합니다.

---

### 멀티프로세스와 멀티스레드 비교  

| **구분**           | **멀티프로세스**                         | **멀티스레드**                                |
| ------------------ | ---------------------------------------- | --------------------------------------------- |
| **정의**           | 여러 개의 **프로세스**를 동시에 실행     | 하나의 프로세스에서 여러 **스레드** 실행      |
| **메모리 사용**    | 각 프로세스가 **독립적인 메모리** 사용   | **코드, 힙, 데이터 영역** 공유, 스택은 독립적 |
| **문맥 교환 비용** | 프로세스 간 **문맥 교환** 비용이 큼      | 스레드 간 문맥 교환 비용이 상대적으로 적음    |
| **안정성**         | 프로세스 간 격리로 오류 전파 위험이 낮음 | 하나의 스레드 오류가 **전체 프로세스**에 영향 |
| **자원 공유**      | 자원 공유가 어렵고, **IPC** 필요         | 자원을 자연스럽게 공유                        |

---

## 프로세스 간 통신(IPC)

프로세스는 기본적으로 **자원을 공유하지 않기** 때문에 데이터를 주고받기 위해 **프로세스 간 통신(IPC)**이 필요합니다.

- **IPC 기법**:  
  프로세스들이 데이터를 주고받는 다양한 방법입니다.  

- **공유 메모리 (Shared Memory, shm)**:  
  특정 메모리 영역을 여러 프로세스가 공유하여 데이터를 주고받는 방식입니다.

> **IPC**를 통해 독립된 프로세스 간에도 데이터를 효율적으로 공유할 수 있습니다.  
{: .prompt-info }

---

> 위 내용은 한빛미디어의 "혼자 공부하는 컴퓨터 구조+운영체제" 교재를 학습하고 정리한 글입니다.  
{: .prompt-tip }
